# Snakemake Workflow for Module 2: Aligning sequences with STAR Index Files

# Include common settings
include: "../common.snakefile"

##### target rules #####
# pseudorule consuming all the final output
rule all:
    input:
        expand('{tmpstore}/star-align/{reference}/{fileprefix}/Aligned.out.bam', tmpstore=tmpstore, reference = reference, fileprefix = fileprefixes)

# the alignment by STAR
rule needed:
    input:
        fq = expand((os.path.join(config['data'], config['sequences'], '') + "{fileprefix}" + "{filesuffix}".format(filesuffix=config['filesuffix']['align'][0])), fileprefix=fileprefixes) 
    output:
        expand('{tmpstore}/star-align/{reference}/{fileprefix}/Aligned.out.bam', tmpstore=tmpstore, reference = reference, fileprefix=samples['fileprefix'])
    script: 'star-align/Snakefile'
